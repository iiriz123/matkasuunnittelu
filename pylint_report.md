# Pylint raportti

```
************* Module app
app.py:1:0: C0114: Missing module docstring (missing-module-docstring)
app.py:19:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:24:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:32:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:36:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:44:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:60:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:80:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:106:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:117:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:123:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:167:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:186:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:205:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:218:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:243:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:253:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:270:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:317:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:331:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
app.py:317:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:338:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:338:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:372:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:382:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
app.py:372:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:396:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:403:0: C0116: Missing function or method docstring (missing-function-docstring)
app.py:407:0: C0116: Missing function or method docstring (missing-function-docstring)
************* Module config
config.py:1:0: C0114: Missing module docstring (missing-module-docstring)
config.py:1:0: C0103: Constant name "secret_key" doesn't conform to UPPER_CASE naming style (invalid-name)
************* Module db
db.py:1:0: C0114: Missing module docstring (missing-module-docstring)
db.py:4:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:10:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:10:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
db.py:17:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:20:0: C0116: Missing function or method docstring (missing-function-docstring)
db.py:20:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
************* Module items
items.py:1:0: C0114: Missing module docstring (missing-module-docstring)
items.py:3:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:7:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:19:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:19:0: R0913: Too many arguments (6/5) (too-many-arguments)
items.py:19:0: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)
items.py:31:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:36:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:43:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:47:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:51:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:56:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:60:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:64:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:77:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:89:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:89:0: R0913: Too many arguments (6/5) (too-many-arguments)
items.py:89:0: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)
items.py:103:0: C0116: Missing function or method docstring (missing-function-docstring)
items.py:113:0: C0116: Missing function or method docstring (missing-function-docstring)
************* Module seed
seed.py:1:0: C0114: Missing module docstring (missing-module-docstring)
seed.py:11:0: C0103: Constant name "user_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:12:0: C0103: Constant name "item_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:13:0: C0103: Constant name "comment_count" doesn't conform to UPPER_CASE naming style (invalid-name)
************* Module users
users.py:1:0: C0114: Missing module docstring (missing-module-docstring)
users.py:5:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:10:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:15:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:28:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:33:0: C0116: Missing function or method docstring (missing-function-docstring)
users.py:40:4: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
users.py:1:0: R0801: Similar lines in 2 files
==items:[69:74]
==users:[20:25]
            GROUP BY items.id
            ORDER BY items.id DESC
            LIMIT ? OFFSET ?"""
    limit = page_size
    offset = page_size * (page - 1) (duplicate-code)

------------------------------------------------------------------
Your code has been rated at 8.45/10 (previous run: 8.43/10, +0.02)
```

## Docstring-ilmoitukset

Suurin osa huomautuksista on docstring-ilmoituksia mikä tarkoittaa, että sovelluksen moduuleissa ja funktioissa ei ole docstring-kommentteja. Sovelluksen kehityksessä on tehty tietoinen päätös ettei käytetä docstring-kommentteja.

## Tarpeeton else

Raportissa on seuraavat ilmoitukset liittyen `else` -haaroihin:

```
app.py:331:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
app.py:382:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
users.py:40:4: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
```

Esimerkiksi ensimmäinen ilmoitus koskee seuraavaa koodia:

```python
if request.method == "POST":
    check_csrf()
    if "remove" in request.form:
        items.remove_item(item_id)
        return redirect("/")
    else:
        return redirect("/item/" + str(item_id))
```

Tämä koodi olisi mahdollista kirjoittaa tiiviimmin ilman `else` -haaraa, mutta sovelluksen kehittäjän näkemyksen mukaan tällaisissa tapauksissa on selkeämpää kirjoittaa `else`-haara, koska se tuo esille kaksi vaihtoehtoa, miten koodi voi toimia eri tilanteissa.

## Puuttuva palautusarvo

Raportissa on seuraavat ilmoitukset liittyen funktion palautusarvoon:

```
app.py:317:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:338:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
app.py:382:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
app.py:372:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)
```

Huomatukset tulevat samankaltaisista funktioista, jotka käsittelevät metodfeja `GET` ja `POST`, mutta ei muita metodeja. Esimerkki alla kuvattuna:

```python
@app.route("/remove_item/<int:item_id>", methods=["GET", "POST"])
def remove_item(item_id):
    require_login()
    item = items.get_item(item_id)

    if not item:
        abort(404)
    if item["user_id"] != session["user_id"]:
        abort(403)

    if request.method == "GET":
        return render_template("remove_item.html", item=item)

    if request.method == "POST":
        check_csrf()
        if "remove" in request.form:
            items.remove_item(item_id)
            return redirect("/")
        else:
            return redirect("/item/" + str(item_id))
```

Tässä funktio palauttaa arvon, kun `request.method` on `GET` tai `POST`, mutta periaatteessa voisi tulla tilanne, jossa `request.method` on jotain muuta eikä koodi palauttaisi arvoa. Käytännössä tällainen tilanne on kuitenkin mahdoton, koska funktion dekoraattorissa on vaatimus, että metodin tulee olla `GET` tai `POST`. Niinpä tässä tapauksessa ei ole riskiä, että funktio ei jossain tilanteessa palauttaisi arvoa.

## Vakion nimi

Raportti antaa seuraavat ilmoitukset liittyen vakioiden nimiin:

```
config.py:1:0: C0103: Constant name "secret_key" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:11:0: C0103: Constant name "user_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:12:0: C0103: Constant name "item_count" doesn't conform to UPPER_CASE naming style (invalid-name)
seed.py:13:0: C0103: Constant name "comment_count" doesn't conform to UPPER_CASE naming style (invalid-name)
```

Pylintin mukaan koodin päätasolla määritetyt vakiot tulisi kirjoittaa suurilla kirjaimilla. Sovelluksen kehittäjän näkemyksen mukaan tässä tilanteessa näyttää paremmalta, että muuttujan nimi on pienillä kirjaimilla, minkä takia niihin ei tehty muutoksia.

## Vaarallinen oletusarvo

Raportissa on seuraavat ilmoitukset liittyen vaaralliseen oletusarvoon:

```
db.py:10:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
db.py:20:0: W0102: Dangerous default value [] as argument (dangerous-default-value)
```

Ensimmäinen ilmoitus on esimerkiksi seuraavasta funktiosta:

```python
def execute(sql, params=[]):
    con = get_connection()
    result = con.execute(sql, params)
    con.commit()
    g.last_insert_id = result.lastrowid
    con.close()
```

Tässä parametrin `params` oletusarvo on tyhjä lista (`[]`). Ongelmana tässä on että jos jossain funktion kutsussa listan sisältöä muutettaisiin, tämä muutos näkyisi myös muihin funktion kutsuihin. Tämä varoitus voidaan ohittaa, koska funktion sisällä olevat koodikutsut eivät muuta listaoliota.

## Liikaa argumentteja

Raportissa on seuraava ilmoitus liittyen funktion argumenttien määrään:

```
items.py:19:0: R0913: Too many arguments (6/5) (too-many-arguments)
items.py:89:0: R0913: Too many arguments (6/5) (too-many-arguments)
```

Esimerkkinä ensimmäinen ilmoitus koskee seuraavaa funktiota:

```python
def add_item(destination, start_date, end_date, description, user_id, classes):
    sql = """INSERT INTO items (destination, start_date, end_date, description, user_id)
    VALUES (?, ?, ?, ?, ?)"""
    db.execute(sql, [destination, start_date, end_date, description, user_id])

    item_id = db.last_insert_id()

    sql = "INSERT INTO item_classes (item_id, title, value) VALUES (?, ?, ?)"
    for title, value in classes:
        db.execute(sql, [item_id, title, value])
    return item_id
```

Pylint haluaa välttää liian monen argumentin käyttämistä funktiossa, käyttäen oletusylärajana viittä argumenttia. Tässä kuuden argumentin käyttö on perusteltua, koska matkasuunnitelman lisäämiseen kaikki argumentit ovat välttämättömiä. Funktion refaktoroiminen erilliseen olioon tai argumenttien pakkaaminen sanakirjaan tekisi koodista vähemmän läpinäkyvää. 
